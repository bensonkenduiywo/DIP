<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Maize yield prediction</title>

<script src="site_libs/header-attrs-2.8/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Digital Image Processing in R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-gear"></span>
     
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="lesson1.html">Data storage schema</a>
    </li>
    <li>
      <a href="fusion.html">Image Fusion</a>
    </li>
    <li>
      <a href="mapping.html">Crop mapping</a>
    </li>
    <li>
      <a href="modis.html">Yield prediction</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:bensonkemboi@gmail.com">
    <span class="fas fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/bensonkenduiywo">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/bensonkenduiywo">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/benson-kenduiywo-1a218137">
    <span class="fab fa-linkedin fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Maize yield prediction</h1>

</div>


<div id="satellite-data" class="section level2">
<h2>Satellite data</h2>
<p>Get EVI, NDVI, Gross Primary Productivity (GPP), and Fraction of Photosynthetically Active Radiation (FPAR) MODIS products. NDVI and EVI products can be found in both Terra and Aqua satellites with product names <strong>MOD13Q1</strong> and <strong>MYD13Q1</strong> respectively at 250 m spatial resolution as 16 day composite. GPP 8-day composite is available at 500 km spatial resolution period with product names <strong>MOD17A2H</strong> and <strong>MYD17A2H</strong> in Terra and Aqua respectively <span class="citation">(NASA, 2021)</span>. FPAR 8-day composite is available at 500 m spatial resolution as combined product of Terra and Aqua coded as <strong>MCD15A2H</strong>.</p>
<pre class="r"><code>if (!&quot;luna&quot; %in% installed.packages()){
  remotes::install_github(&quot;rspatial/luna&quot;)
}
library(luna)
prod &lt;- getProducts(&quot;^MOD13Q1|^MYD13Q1|^MOD17A2|^MYD17A2&quot;)
knitr::kable(table(head(prod, n=3)), align = &#39;l&#39;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">provider</th>
<th align="left">concept_id</th>
<th align="left">short_name</th>
<th align="left">version</th>
<th align="left">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">LPDAAC_ECS</td>
<td align="left">C107705237-LPDAAC_ECS</td>
<td align="left">MOD13Q1</td>
<td align="left">005</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">LPDAAC_ECS</td>
<td align="left">C115315503-LPDAAC_ECS</td>
<td align="left">MOD13Q1</td>
<td align="left">005</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">LPDAAC_ECS</td>
<td align="left">C117500873-LPDAAC_ECS</td>
<td align="left">MOD13Q1</td>
<td align="left">005</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">LPDAAC_ECS</td>
<td align="left">C107705237-LPDAAC_ECS</td>
<td align="left">MOD17A2</td>
<td align="left">005</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">LPDAAC_ECS</td>
<td align="left">C115315503-LPDAAC_ECS</td>
<td align="left">MOD17A2</td>
<td align="left">005</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">LPDAAC_ECS</td>
<td align="left">C117500873-LPDAAC_ECS</td>
<td align="left">MOD17A2</td>
<td align="left">005</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">LPDAAC_ECS</td>
<td align="left">C107705237-LPDAAC_ECS</td>
<td align="left">MYD13Q1</td>
<td align="left">005</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">LPDAAC_ECS</td>
<td align="left">C115315503-LPDAAC_ECS</td>
<td align="left">MYD13Q1</td>
<td align="left">005</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">LPDAAC_ECS</td>
<td align="left">C117500873-LPDAAC_ECS</td>
<td align="left">MYD13Q1</td>
<td align="left">005</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
<p>We are almost ready to download the data. Let’s get Eswatini country boundary and start data downloads.</p>
<pre class="r"><code>library(raster)</code></pre>
<pre><code>## Loading required package: sp</code></pre>
<pre class="r"><code>sz &lt;- getData(&quot;GADM&quot;, country=&quot;SWZ&quot;, level=0)
plot(sz)
text(sz,sz$NAME_0)</code></pre>
<p><img src="modis_files/figure-html/m2-1.png" width="672" /></p>
<p>Define data parameters: product name, start and end date, and area of interest. According <a href="http://www.fao.org/giews/countrybrief/country.jsp?code=SWZ">Food and Agriculture Organization (FAO)</a>, maize is grown in Eswatini between October–May with the growing season covering January–March. We adopt the growing season for yield prediction. We define date as follows:</p>
<pre class="r"><code>start &lt;- &quot;2018-01-01&quot;
end &lt;- &quot;2019-12-31&quot;</code></pre>
<p>Thereafter, extract existing data files.</p>
<pre class="r"><code>product &lt;- &quot;MOD13Q1&quot;
mf &lt;- luna::getModis(product, start, end, aoi=sz, download = FALSE)
length(mf)</code></pre>
<pre><code>## [1] 70</code></pre>
<p>MODIS data can be download from <a href="https://urs.earthdata.nasa.gov/users">EarthData</a>. This requires specification of a storage directory, a user’s name and password. Here, the password is saved in a directory. We download the maize growing season months only.</p>
<pre class="r"><code>pass &lt;- readRDS(&quot;earthdata.rds&quot;)
modis_path &lt;- &quot;D:/JKUAT/RESEARCH_Projects/Eswatini/Data/MODIS/raw/&quot;  
mstart &lt;- &quot;-01-01&quot;
mend &lt;- &quot;-03-31&quot;
for(y in 2000:2020){
  cat(y,&quot;downloading..\t&quot;)
  start &lt;- paste0(y,mstart)
  end   &lt;- paste0(y,mend)
  luna::getModis(product, start, end, aoi=sz, download=TRUE,
                     path=modis_path, username=pass$username,
                     password=pass$password)
}</code></pre>
<pre><code>## 2000 downloading..   
## 2001 downloading..   
## 2002 downloading..   
## 2003 downloading..   
## 2004 downloading..   
## 2005 downloading..   
## 2006 downloading..   
## 2007 downloading..   
## 2008 downloading..   
## 2009 downloading..   
## 2010 downloading..   
## 2011 downloading..   
## 2012 downloading..   
## 2013 downloading..   
## 2014 downloading..   
## 2015 downloading..   
## 2016 downloading..   
## 2017 downloading..   
## 2018 downloading..   
## 2019 downloading..   
## 2020 downloading..   </code></pre>
<p>Similarly, GPP and FPAR can be downloaded by changing the product type e.g. <strong>MCD15A2H</strong> for FPAR. Next we explore the images we have downloaded and start extracting information we require for yield prediction.</p>
<p><a href="MODISprocessing.html">NEXT PAGE</a>.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-12_NASA_2021" class="csl-entry">
NASA. (2021). <em><span>Data Products</span></em>. Retrieved from <a href="https://modis.gsfc.nasa.gov/data/dataprod/index.php">https://modis.gsfc.nasa.gov/data/dataprod/index.php</a>
</div>
</div>
</div>

<p> Created 14th May 2021 Copyright &copy; Benson Kenduiywo, Inc. All rights reserved.</p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
